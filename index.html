<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Classic Movies Collection</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for a classic cinematic feel */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #121212; /* Deep Charcoal Background */
            color: #E2E8F0;
        }
        .poster-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            background-color: #1e1e1e; /* Darker card background */
            cursor: pointer;
        }
        .poster-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 30px rgba(255, 204, 0, 0.3); /* Stronger gold glow */
        }
        .text-golden {
            color: #FFC300; /* Classic Gold accent */
        }
        .poster-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            aspect-ratio: 2 / 3;
        }
        /* Style for the responsive video container (16:9 aspect ratio) */
        .video-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 9 / 16 = 0.5625 */
            height: 0;
            overflow: hidden;
            background-color: #000;
            border-radius: 0.75rem;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.7);
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body class="min-h-screen text-gray-100">

    <script>
        // === START OF ISOLATED SCOPE (IIFE) ===
        (function() {
            
            // ===========================================
            // === MOVIE DATA CATALOG ===
            // ===========================================
            const CLASSIC_CATALOG = {
                "royal_wedding": {
                    title: "Royal Wedding",
                    year: 1951,
                    type: "Musical",
                    posterUrl: "images/royal wedding.jpg",
                    description: "A musical  starring Fred Astaire as a dancer traveling to London for the 1947 Royal Wedding.",
                    videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed/2015728306909" title="Royal Wedding (1951) Video Player" frameborder="0" allowfullscreen></iframe>'
                },
                "Sunset_Boulevard": {
                    title: "Sunset Boulevard",
                    year: 1950,
                    type: "Film Noir", 
                    posterUrl:"images/sunset.jpg",
                    description: "A hack screenwriter is drawn into the fantasy world of a faded silent movie star who dreams of a triumphant return.",
                    detailsLink: "classic_details.html?id=Sunset_Boulevard",
                    videoEmbedHtml: '<iframe src="https://ok.ru/videoembed/8934297176633" title="Placeholder Video Player" frameborder="0" allowfullscreen></iframe>'
                },
                "fort_apache_1": {
                    title: "Fort Apache (1)",
                    year: 1948,
                    type: "Western", 
                    posterUrl: "images/apache.jpg",
                    description: "Colonel Oswald Turner, who serves as the commanding officer at Fort Apache, clashes with Captain Kirby York, his deputy, as the former wants to become popular in the Arizona outpost.",
                    videoEmbedHtml: '<iframe src="https://ok.ru/videoembed/8921373280921" title="Placeholder Video Player" frameborder="0" allowfullscreen></iframe>'
                },
                "caligula": {
                    title: "Calígula",
                    year: 1979,
                    type: "Epic Drama",
                    posterUrl: "images/Calígula.jpg",
                    description: "A controversial historical epic detailing the corrupt and violent reign of the Roman Emperor Caligula.",
                    videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed/9412093348547" title="Caligula Trailer" frameborder="0" allowfullscreen></iframe>'
                },
                "She_Wore_a_Yellow_Ribbon": {
                    title: "She Wore a Yellow Ribbon",
                    year: 1949,
                    type: "Western",
                    posterUrl: "images/ribbon.jpg",
                    description: "Captain Nathan Brittles heads his last assignment before retirement to stop a Native American attack. But the job gets challenging when his superior instructs him to escort two women to safety.",
                    videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed/8921446943385" title="Caligula Trailer" frameborder="0" allowfullscreen></iframe>'
                },
                "El_Cid": {
                    title: "El Cid",
                    year: 1961,
                    type: "Action Drama",
                    posterUrl: "images/cid.jpg",
                    description: "A brave Castilian knight, El Cid, urges Spaniards to unite to oust their foreign Moorish rulers. But the megalomaniacal Castilian ruler expels El Cid from Castile as his anti-Moorish campaign starts.",
                    videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed/2431261149849" title="Caligula Trailer" frameborder="0" allowfullscreen></iframe>'
                },
                "la_confidential": {
                    title: "L.A. Confidential",
                    year: 1997,
                    type: "Action Drama", 
                    posterUrl: "images/L.A. Confidential.jpg",
                    description: "Three detectives from Los Angeles Police Department investigate multiple homicides. While unearthing the evidence and the suspects, the trail leads to corruption in their own department.",
                    videoEmbedHtml: '<iframe src="https://ok.ru/videoembed/1167199373828" title="Placeholder Video Player" frameborder="0" allowfullscreen></iframe>'
                },
                "The_African_Queen": {
                    title: "The African Queen",
                    year: 1951,
                    type: "Adventure Drama", 
                    posterUrl: "images/The African Queen.jpg",
                    description: "Charlie Allnut, the captain of a steamer called the African Queen, meets Rose Sayer, sister of a British missionary, Samuel Sayer. In spite of being totally opposite to each other, they fall in love.",
                    videoEmbedHtml: '<iframe src="https://ok.ru/videoembed/9129024555678" title="Placeholder Video Player" frameborder="0" allowfullscreen></iframe>'
                },
                "The_7th_Voyage_Of_Sinbad": {
                    title: "The 7th Voyage Of Sinbad",
                    year: 1958,
                    type: "Adventure", 
                    posterUrl: "images/sinbad.jpg",
                    description: "As Sinbad sets off to get married, Sokurah, the sorcerer, creates trouble as he decreases the size of the princess. To save his bride, Sinbad must go back to Colossa and find a magic lamp.",
                    videoEmbedHtml: '<iframe src="https://ok.ru/videoembed/9770835053214" title="Placeholder Video Player" frameborder="0" allowfullscreen></iframe>'
                },
                "the_searchers": {
                    title: "The Searchers",
                    year: 1956,
                    type: "Western",
                    posterUrl: "images/the-searchers-poster.jpg",
                    description: "A Civil War veteran spends years searching for his abducted niece, whose captor is a Comanche tribe.",
                    videoEmbedHtml: '<iframe src="https://ok.ru/videoembed/4705978485410" title="The Searchers Video Player" frameborder="0" allowfullscreen></iframe>'
                },
                "Wolfen": {
                    title: "Wolfen",
                    year: 1981,
                    type: "Action Horror",
                    posterUrl: "images/Wolfen.jpg",
                    description: "A cop is assigned to solve a bizarre set of murders, which appear that the victims were attacked and killed by animals. During his investigations, he makes a shocking discovery about an old legend.",
                    videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed/9474389183134" title="Caligula Trailer" frameborder="0" allowfullscreen></iframe>'
                },
                "Creature_from_the_Black_Lagoon": {
                    title: "Creature from the Black Lagoon Colorized",
                    year: 1954,
                    type: "Action Sci-fi", 
                    posterUrl:"images/lagoon.jpg",
                    description: "Yes, a colorized version of the original 1954 Creature from the Black Lagoon exists, though it's generally unofficial, with fan-made AI colorizations and manufactured-on-demand DVDs/Blu-rays available, ",
                    videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed/9443755625118" title="Caligula Trailer" frameborder="0" allowfullscreen></iframe>'
                },
                "casablanca": { 
                    title: "Casablanca", 
                    year: 1942,
                    type: "Movie Drama",
                    posterUrl:"images/Casablanca.jpg",
                    description: "During WWII, Rick, a nightclub owner in Casablanca, agrees to help his former lover Ilsa and her husband. Soon, Ilsa's feelings for Rick resurface and she finds herself renewing her love for him.",
                    videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed/2859348462121" title="Caligula Trailer" frameborder="0" allowfullscreen></iframe>'
                },
                "The_Bridge_On_The_River_Kwai": { 
                    title: "The Bridge On The River Kwai",
                    year: 1957,
                    type: "Action War", 
                    posterUrl: "images/kwai.jpg",
                    description: "Colonel Nicholson reluctantly agrees to camp commander Saito's suggestion of getting the World War II POWs to build a railway bridge. However, the project soon becomes an obsession for him.",
                    videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed/1021675964975" title="The Bridge On The River Kwai Player" frameborder="0" allowfullscreen></iframe>'
                },
                "Moll_Flanders": { 
                    title: "Moll Flanders",
                    year:1996,
                    type: "Adventure",
                    posterUrl: "images/moll.jpg",
                    description: "Moll, a spirited and headstrong woman works as a model for an artist who helps her change her for the better. However, her fate takes a turn, hampering her happiness",
                    videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed/9381637589662" title="Moll Flanders Player" frameborder="0" allowfullscreen></iframe>'
                },
                "Walt_Disney's_Sleeping_Beauty": { 
                    title: "Walt Disney's Sleeping Beauty",
                    year:1959,
                    type: "Walt Disney Cartoon",
                    posterUrl: "images/sleeping.jpg",
                    description: "A witch curses a newborn princess to die on her 16th birthday. However, a fairy alters the curse, allowing the princess to survive by going into a deep sleep that can be broken by true love's kiss.",
                    videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed/9316678634142" title="Walt Disney\'s Sleeping Beauty Player" frameborder="0" allowfullscreen></iframe>'
                },
                "Walt_Disney's_That_Darn_Cat": { 
                    title: "Walt Disney's That Darn Cat",
                    year: 1997,
                    type: "Walt Disney Comedy",
                    posterUrl: "images/cat.jpg",
                    description: "Patti is bored with her sleepy hometown but gets some exctiment when her tomcat, Darn Cat, delivers an an important clue in a mysterious kidnapping.",
                    videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed/9316680927902" title="Walt Disney\'s That Darn Cat Player" frameborder="0" allowfullscreen></iframe>'
                },
                // Placeholder for the new movie the user added (to ensure the total count is dynamic)
                "Walt_Disney's_The_Absent_Minded_Professor": {
                    title: "Walt Disney's The Absent Minded Professor",
                    year: 1961,
                    type: "Modern Classic",
                    posterUrl: "images/absent.jpg",
                    description: "A professor makes an extraordinary flying rubber that he uses for his many adventures. Jealous of his invention, a corrupt businessman wants to get his hands on it. Will he be successful?",
                    videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed/9247184521886" title="Race with the Devil" frameborder="0" allowfullscreen></iframe>'
                },
                  "Race_with_the_Devil": {
                    title: "Race with the Devil",
                    year: 1975,
                    type: "Modern Classic action",
                    posterUrl: "images/race.jpg",
                    description: "Two couples vacationing together in an R.V. from Texas to Colorado are terrorized after they witness a murder during a Satanic ritual.",
                  videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed/9316197075614" title="Race with the Devil" frameborder="0" allowfullscreen></iframe>'
                },
                 "Darby_O'Gill_and_the_Little_People": {
                    title: "Walt Disney's Darby O'Gill and the Little People",
                    year: 1959,
                    type: "Modern Classic Adventure",
                    posterUrl: "images/darby.jpg",
                    description: "Just-fired Darby O'Gill (Albert Sharpe) does not want to tell his daughter, Katie (Janet Munro), that his position has been taken by a dashing younger man (Sean Connery). Then, on his way home, Darby slips through a portal to the land of the little people. There he meets the leprechaun king, Brian (Jimmy O'Dea), and winds up accidentally bringing the little monarch home with him. Darby then demands Brian grant him three wishes, but the request brings Darby bittersweet, and unexpected, results",
                  videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed/9247175346846" title="Race with the Devil" frameborder="0" allowfullscreen></iframe>'
                },
                 "Them": {
                    title: "Them! Colorized",
                    year: 1954,
                    type: "Modern Classic Horror",
                    posterUrl: "images/them.jpg",
                    description: "Them! is a 1954 black-and-white science fiction giant monster film starring James Whitmore, Edmund Gwenn, Joan Weldon, and James Arness",
                  videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed//9063309183646" title="Race with the Devil" frameborder="0" allowfullscreen></iframe>'
                },
                 "Southern_Comfort": {
                    title: "Southern Comfort",
                    year: 1954,
                    type: "Modern Classic Action",
                    posterUrl: "images/southern.jpg",
                    description: "During the Vietnam War, a squad of National Guardsmen -- including Hardin (Powers Boothe), a no-nonsense Texan; Reece (Fred Ward), a hunter; and Spencer (Keith Carradine), a sensible private -- take part in a military training exercise in the swamps of Louisiana. After attempting to steal several canoes and firing blanks at a Cajun, the group members find themselves being hunted by the locals. Scared and unfamiliar with the territory, the men must scramble to escape",
                  videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed//8586721102494" title="Race with the Devil" frameborder="0" allowfullscreen></iframe>'
                },
                  "Porkys": {
                    title: "Porkys",
                    year: 1982,
                    type: "Modern Classic Comedy",
                    posterUrl: "images/porkys.jpg",
                    description: "In 1954, a group of Florida high school guys vow revenge after being harassed by a sleazy nightclub owner and his redneck sheriff brother.",
                  videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed//9886683630238" title="Race with the Devil" frameborder="0" allowfullscreen></iframe>'
                },
                 
                 "Butch_Cassidy_and_the_Sundance_Kid": {
                    title: "Butch Cassidy and the Sundance Kid",
                    year: 1969,
                    type: "Modern Classic Western",
                    posterUrl: "images/butch.jpg",
                    description: "In 1890s Wyoming, Butch Cassidy and The Sundance Kid lead a band of outlaws. When a train robbery goes wrong, they find themselves on the run with a posse hard on their heels",
                  videoEmbedHtml: '<iframe class="w-full h-full" src="https://ok.ru/videoembed//9886346447518" title="Race with the Devil" frameborder="0" allowfullscreen></iframe>'
                }

            }; 
            
            // ===========================================
            // === APP STATE AND CONTROLS (ISOLATED) ===
            // ===========================================
            // Reverted back to 6 items per page (or set this to your desired standard)
            const ITEMS_PER_PAGE = 6; 
            let currentPage = 1;      
            let currentView = 'list';
            let currentId = null;
            const APP_TITLE = "Classic Movies Collection";
            
            // --- ISOLATED STATE VARIABLES ---
            let currentSort = 'year_desc'; 
            let currentFilter = 'all';     
            // ----------------------------------

            // --- NAVIGATION & ROUTING FUNCTIONS ---

            function navigateToDetails(movieId) {
                window.location.hash = `details/${movieId}`;
            }

            function navigateToList() {
                window.location.hash = '';
            }

            function router() {
                const hash = window.location.hash.slice(1);
                
                if (hash.startsWith('details/')) {
                    const movieId = hash.split('/')[1];
                    if (CLASSIC_CATALOG[movieId]) {
                        currentView = 'details';
                        currentId = movieId;
                        render();
                        return;
                    }
                }
                
                currentView = 'list';
                currentId = null;
                render();
            }
            
            // --- PAGINATION CONTROL FUNCTIONS ---

            function changePage(newPage) {
                currentPage = newPage;
                render();
            }

            function renderPaginationControls(totalPages, totalItems) {
                const controlsContainer = document.getElementById('pagination-controls');
                // Don't show controls if there's only one page
                if (!controlsContainer || totalItems <= ITEMS_PER_PAGE) {
                    if (controlsContainer) controlsContainer.innerHTML = '';
                    return;
                }

                let paginationHtml = '<nav class="flex space-x-2 p-3 bg-gray-800/50 rounded-lg shadow-inner">';
                
                // Previous Button
                const prevDisabled = currentPage === 1 ? 'disabled' : '';
                const prevClass = currentPage === 1 ? 'text-gray-400 bg-gray-700/50 cursor-not-allowed' : 'text-gray-300 bg-gray-700 hover:bg-gray-600 transition';
                paginationHtml += `<button onclick="changePage(${currentPage - 1})" class="px-4 py-2 rounded-lg ${prevClass}" ${prevDisabled}>&larr; Previous</button>`;

                // Page Number Buttons (showing a maximum of 5 pages around the current page)
                let startPage = Math.max(1, currentPage - 2);
                let endPage = Math.min(totalPages, currentPage + 2);
                
                if (currentPage < 3) endPage = Math.min(totalPages, 5);
                if (currentPage > totalPages - 2) startPage = Math.max(1, totalPages - 4);

                // *** REMOVED HARD PAGE LIMITS HERE ***
                // endPage = Math.min(endPage, 3); // Removed line that limited button visibility
                
                for (let i = startPage; i <= endPage; i++) {
                    const activeClass = i === currentPage ? 'text-gray-900 bg-golden font-bold shadow-md hover:bg-yellow-400' : 'text-gray-300 bg-gray-700 hover:bg-gray-600 transition';
                    paginationHtml += `<button onclick="changePage(${i})" class="px-4 py-2 rounded-lg ${activeClass}">${i}</button>`;
                }

                // Next Button
                // Disabled only when current page is the last page (totalPages)
                const nextDisabled = currentPage === totalPages ? 'disabled' : '';
                const nextClass = currentPage === totalPages ? 'text-gray-400 bg-gray-700/50 cursor-not-allowed' : 'text-gray-300 bg-gray-700 hover:bg-gray-600 transition';
                // *** REMOVED HARD PAGE LIMITS HERE ***
                // const nextDisabled = currentPage >= totalPages || currentPage >= 3 ? 'disabled' : ''; // Replaced this line
                
                paginationHtml += `<button onclick="changePage(${currentPage + 1})" class="px-4 py-2 rounded-lg ${nextClass}" ${nextDisabled}>Next &rarr;</button>`;

                paginationHtml += '</nav>';
                controlsContainer.innerHTML = paginationHtml;
            }

            // --- SORT AND FILTER HANDLERS (Simplified) ---
            
            function applySortAndFilter() {
                const sortSelect = document.getElementById('sort-select');
                const filterSelect = document.getElementById('filter-select');
                
                // 1. Update State
                currentSort = sortSelect.value;
                currentFilter = filterSelect.value;
                
                // 2. Reset to Page 1 and Re-render
                currentPage = 1;
                render(); 
            }
            
            // --- RENDER FUNCTIONS ---

            // Renders the main catalog list view
            function renderList(appContainer) {
                // 1. Convert to Array
                const allMovieEntries = Object.entries(CLASSIC_CATALOG);

                // 2. Apply Filtering 
                let filteredMovies = allMovieEntries.filter(([id, movie]) => {
                    // Ignore entries that don't have a title 
                    if (!movie.title) return false; 
                    
                    // --- Filter Logic (by Decade) ---
                    let decadeMatches = true;
                    if (currentFilter !== 'all') {
                        const movieDecade = Math.floor(movie.year / 10) * 10;
                        const filterDecade = parseInt(currentFilter);
                        
                        if (currentFilter === 'other') {
                            // Keep entries older than 1940 OR newer than 1969
                            decadeMatches = movie.year < 1940 || movie.year > 1969;
                        } else {
                            // Keep entries that match the selected decade (e.g., 1950s is year >= 1950 and year < 1960)
                            decadeMatches = movieDecade === filterDecade;
                        }
                    }
                    
                    return decadeMatches;
                });

                // 3. Apply Sorting
                filteredMovies.sort(([, a], [, b]) => {
                    if (currentSort === 'year_asc') {
                        return a.year - b.year;
                    } else if (currentSort === 'year_desc') {
                        return b.year - a.year;
                    } else if (currentSort === 'title_asc') {
                        return a.title.localeCompare(b.title);
                    } else if (currentSort === 'title_desc') {
                        return b.title.localeCompare(a.title);
                    }
                    return 0;
                });

                // 4. Pagination Logic
                const totalItems = filteredMovies.length;
                const totalPages = Math.ceil(totalItems / ITEMS_PER_PAGE);

                // Ensure currentPage is not out of bounds after filtering
                if (currentPage > totalPages && totalPages > 0) {
                    currentPage = totalPages;
                } else if (totalPages === 0) {
                    currentPage = 1;
                }
                
                // *** REMOVED HARD PAGE LIMITS HERE ***
                // if (currentPage > 3) { currentPage = 3; } // Removed line that restricted max page
                
                const startIndex = (currentPage - 1) * ITEMS_PER_PAGE;
                const endIndex = Math.min(startIndex + ITEMS_PER_PAGE, totalItems);

                const moviesToDisplay = filteredMovies.slice(startIndex, endIndex);

                document.getElementById('page-title').textContent = APP_TITLE;

                // Function to set 'selected' attribute on options
                const isSelected = (value, current) => value === current ? 'selected' : '';

                appContainer.innerHTML = `
                    <section class="mb-12 p-8 md:p-12 rounded-xl bg-gray-800/70 border-b-4 border-golden shadow-2xl">
                        <h2 class="text-5xl font-extrabold mb-3 text-white">The Golden Age of Cinema</h2>
                        <p class="text-lg text-gray-300 max-w-3xl">
                            A curated selection of timeless classics, defining masterpieces, and influential works from the early days of film history.
                        </p>
                        <div class="mt-4 flex flex-wrap gap-3">
                            <span class="text-sm font-medium bg-golden text-gray-900 px-3 py-1 rounded-full shadow-md">Pre-Code</span>
                            <span class="text-sm font-medium bg-gray-600 text-gray-100 px-3 py-1 rounded-full shadow-md">Film Noir</span>
                            <span class="text-sm font-medium bg-gray-600 text-gray-100 px-3 py-1 rounded-full shadow-md">Public Domain Gems</span>
                        </div>
                    </section>

                    <div class="mb-8 flex flex-col sm:flex-row justify-between items-start sm:items-center p-4 bg-gray-800/50 rounded-lg">
                        <h3 class="text-2xl font-semibold text-white mb-4 sm:mb-0">Showing ${moviesToDisplay.length} of ${totalItems} Classics</h3>
                        
                        <div class="flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-4 w-full sm:w-auto ml-auto">

                            <select id="sort-select" onchange="applySortAndFilter()" class="bg-gray-700 text-white p-2 rounded-lg border border-gray-600 focus:ring-golden focus:border-golden transition w-full md:w-40 order-2 md:order-1">
                                <option value="year_desc" ${isSelected('year_desc', currentSort)}>Sort by Year (Newest)</option>
                                <option value="year_asc" ${isSelected('year_asc', currentSort)}>Sort by Year (Oldest)</option>
                                <option value="title_asc" ${isSelected('title_asc', currentSort)}>Sort by Title (A-Z)</option>
                                <option value="title_desc" ${isSelected('title_desc', currentSort)}>Sort by Title (Z-A)</option>
                            </select>
                            
                            <select id="filter-select" onchange="applySortAndFilter()" class="bg-gray-700 text-white p-2 rounded-lg border border-gray-600 focus:ring-golden focus:border-golden transition w-full md:w-40 order-3 md:order-2">
                                <option value="all" ${isSelected('all', currentFilter)}>Filter by Decade (All)</option>
                                <option value="1960" ${isSelected('1960', currentFilter)}>1960s</option>
                                <option value="1950" ${isSelected('1950', currentFilter)}>1950s</option>
                                <option value="1940" ${isSelected('1940', currentFilter)}>1940s</option>
                                <option value="other" ${isSelected('other', currentFilter)}>Other (Pre-1940/Post-1969)</option>
                            </select>
                        </div>
                    </div>

                    <section id="classic_movie_list" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6">
                        </section>
                    
                    <div id="pagination-controls" class="mt-12 flex justify-center"></div>
                `;
                
                const movieGrid = appContainer.querySelector('#classic_movie_list');

                // --- Render Movie Cards ---
                if (moviesToDisplay.length === 0) {
                    movieGrid.innerHTML = `<p class="col-span-full text-center text-xl text-gray-500 py-10">No classics found matching the criteria. Try adjusting your filters.</p>`;
                } else {
                    moviesToDisplay.forEach(([movieId, movie]) => {
                        const cardLink = document.createElement('div');
                        cardLink.onclick = () => navigateToDetails(movieId);
                        cardLink.className = 'poster-card block rounded-lg overflow-hidden';
                        
                        cardLink.innerHTML = `
                            <div class="poster-container">
                                <img class="poster-image" 
                                    src="${movie.posterUrl}" 
                                    alt="Poster for ${movie.title} (${movie.year})" 
                                    onerror="this.onerror=null;this.src='https://placehold.co/200x300/18181B/FFFFFF?text=Poster+Unavailable'">
                            </div>
                            <div class="p-3 text-center">
                                <p class="text-sm font-semibold truncate text-white">${movie.title}</p>
                                <p class="text-xs text-gray-400">${movie.year} &middot; ${movie.type}</p>
                            </div>
                        `;
                        
                        movieGrid.appendChild(cardLink);
                    });
                }

                // Render pagination controls after the grid
                renderPaginationControls(totalPages, totalItems);
            }

            // Renders the single movie detail view
            function renderDetails(appContainer, movieId) {
                const movie = CLASSIC_CATALOG[movieId];
                document.getElementById('page-title').textContent = `${movie.title} Details - ${APP_TITLE}`;

                appContainer.innerHTML = `
                    <div class="bg-gray-800/70 rounded-xl shadow-2xl p-6 md:p-10 transition duration-500 border border-gray-700">
                        <button onclick="navigateToList()" class="mb-6 inline-flex items-center text-golden hover:text-white transition group">
                            <svg class="w-5 h-5 mr-2 group-hover:translate-x-[-2px] transition" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                            Back to Catalog
                        </button>

                        <div class="flex flex-col md:flex-row gap-8">
                            
                            <div class="md:w-1/3 flex-shrink-0">
                                <img src="${movie.posterUrl}" 
                                    alt="Poster for ${movie.title}" 
                                    class="w-full rounded-lg shadow-xl border-2 border-golden/50"
                                    onerror="this.onerror=null;this.src='https://placehold.co/300x450/18181B/FFFFFF?text=Poster+Unavailable'">
                            </div>

                            <div class="md:w-2/3">
                                <span class="text-sm font-semibold uppercase tracking-wider text-golden">${movie.type} (${movie.year})</span>
                                <h1 class="text-5xl font-extrabold mt-1 mb-4 leading-tight text-white">${movie.title}</h1>
                                
                                <div class="text-lg text-gray-300 mb-8 leading-relaxed">
                                    ${movie.description}
                                </div>

                                <div class="space-y-3 p-4 bg-gray-700/50 rounded-lg">
                                    <p class="text-gray-400"><strong class="text-golden">Year:</strong> ${movie.year}</p>
                                    <p class="text-gray-400"><strong class="text-golden">Genre:</strong> ${movie.type}</p>
                                    <p class="text-gray-400"><strong class="text-golden">ID:</strong> <code class="bg-gray-900 px-2 py-1 rounded text-xs">${movieId}</code></p>
                                </div>
                            </div>
                        </div>

                        <div class="mt-12">
                            <h2 class="text-3xl font-bold mb-4 border-b border-gray-700 pb-2 text-golden">Watch Movie</h2>
                            <div class="video-container rounded-xl shadow-2xl">
                                ${movie.videoEmbedHtml}
                            </div>
                            <p class="text-xs text-gray-500 mt-2 text-right">Content embedded from an external source.</p>
                        </div>
                    </div>
                `;
            }

            // Unified render function
            function render() {
                const appContainer = document.getElementById('app-content');
                
                // Update Navigation links to reflect the current view
                const navLinks = document.getElementById('nav-links');
                if (currentView === 'list') {
                    navLinks.innerHTML = `
                        <a href="#list" onclick="navigateToList()" class="text-golden font-semibold bg-gray-800 px-3 py-2 rounded-lg shadow-inner">All Films</a>
                    `;
                } else {
                    navLinks.innerHTML = `
                        <a href="." onclick="navigateToList()" class="text-gray-300 hover:text-golden transition duration-200 p-2 rounded-lg">All Films</a>
                        <span class="text-golden font-semibold bg-gray-800 px-3 py-2 rounded-lg shadow-inner">Details</span>
                    `;
                }

                // Render the specific view
                if (currentView === 'details' && currentId) {
                    renderDetails(appContainer, currentId);
                } else {
                    renderList(appContainer);
                }
                window.scrollTo(0, 0); // Scroll to top on page transition
            }


            // --- INITIALIZATION ---
            window.onload = function() {
                // Listen for changes in the URL hash (client-side routing)
                window.addEventListener('hashchange', router);
                
                // CRITICAL FIX: EXPOSE FUNCTIONS TO GLOBAL SCOPE
                window.applySortAndFilter = applySortAndFilter;
                window.changePage = changePage;
                window.navigateToList = navigateToList;
                
                // Run the router once on load to handle the initial URL
                router();
            };
        })();
        // === END OF ISOLATED SCOPE (IIFE) ===
    </script>

    <header class="bg-black/90 shadow-lg sticky top-0 z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <a href="." onclick="navigateToList()" class="flex-shrink-0 text-3xl font-extrabold text-golden tracking-wider">
                    <span class="hidden sm:inline">CLASSIC</span> <span class="font-normal text-white">FILMS</span>
                </a>
                <nav id="nav-links" class="flex space-x-3"></nav>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto py-10 px-4 sm:px-6 lg:px-8">
        <div id="app-content">
            </div>
    </main>
    
    <footer class="bg-black/90 mt-12 py-6 text-center text-gray-500 text-sm border-t border-gray-800">
        &copy; 2025 Classic Movies Collection. All content is for demonstration purposes.
    </footer>

</body>
</html>